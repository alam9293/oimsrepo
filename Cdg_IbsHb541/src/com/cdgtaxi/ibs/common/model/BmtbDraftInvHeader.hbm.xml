<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN" 
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
    
<hibernate-mapping>
<!-- 
    Created by the Middlegen Hibernate plugin 2.1

    http://boss.bekk.no/boss/middlegen/
    http://www.hibernate.org/
-->

<class 
    name="com.cdgtaxi.ibs.common.model.BmtbDraftInvHeader" 
    table="BMTB_DRAFT_INV_HEADER"
    dynamic-update="true"
    dynamic-insert="true"
>
    <meta attribute="implement-equals" inherit="false">true</meta>

    <id
        name="invoiceHeaderNo"
        type="java.lang.Long"
        column="INVOICE_HEADER_NO"
    >
        <meta attribute="use-in-equals">true</meta>
        <generator class="sequence">
            <param name="sequence_name">BMTB_DRAFT_INV_HEADER_SQ1</param>
        </generator>
    </id>
    <version name="version" column="VERSION"/>

    <property
        name="invoiceNo"
        type="java.lang.Long"
        column="INVOICE_NO"
        length="18"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="invoiceDate"
        type="java.sql.Date"
        column="INVOICE_DATE"
        not-null="true"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="invoiceStatus"
        type="java.lang.String"
        column="INVOICE_STATUS"
        not-null="true"
        length="1"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="invoiceFormat"
        type="java.lang.String"
        column="INVOICE_FORMAT"
        not-null="true"
        length="1"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="dueDate"
        type="java.sql.Date"
        column="DUE_DATE"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="statementPeriodFromDate"
        type="java.sql.Date"
        column="STATEMENT_PERIOD_FROM_DATE"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="statementPeriodToDate"
        type="java.sql.Date"
        column="STATEMENT_PERIOD_TO_DATE"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="prevBalance"
        type="java.math.BigDecimal"
        column="PREV_BALANCE"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="prevPayment"
        type="java.math.BigDecimal"
        column="PREV_PAYMENT"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="newTxn"
        type="java.math.BigDecimal"
        column="NEW_TXN"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="newBalance"
        type="java.math.BigDecimal"
        column="NEW_BALANCE"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="less30Days"
        type="java.math.BigDecimal"
        column="LESS_30_DAYS"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="less60Days"
        type="java.math.BigDecimal"
        column="LESS_60_DAYS"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="less90Days"
        type="java.math.BigDecimal"
        column="LESS_90_DAYS"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="more90Days"
        type="java.math.BigDecimal"
        column="MORE_90_DAYS"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="prevRewardsPts"
        type="java.lang.Integer"
        column="PREV_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="redeemedRewardsPts"
        type="java.lang.Integer"
        column="REDEEMED_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="newRewardsPts"
        type="java.lang.Integer"
        column="NEW_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="totalRewardsPts"
        type="java.lang.Integer"
        column="TOTAL_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="awardedRewardsPts"
        type="java.lang.Integer"
        column="AWARDED_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="expiredRewardsPts"
        type="java.lang.Integer"
        column="EXPIRED_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="adjustedRewardsPts"
        type="java.lang.Integer"
        column="ADJUSTED_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="forfeitedRewardsPts"
        type="java.lang.Integer"
        column="FORFEITED_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
     <property
        name="toExpireRewardsPts"
        type="java.lang.Integer"
        column="TO_EXPIRE_REWARDS_PTS"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="rewardsExpiryDate"
        type="java.sql.Timestamp"
        column="ReWARDS_EXPIRY_DATE"
        length="11"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="accountDeposit"
        type="java.math.BigDecimal"
        column="ACCOUNT_DEPOSIT"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="accountExcess"
        type="java.math.BigDecimal"
        column="ACCOUNT_EXCESS"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="overdueInvoice"
        type="java.lang.String"
        column="OVERDUE_INVOICE"
        length="255"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="txnCutoffDate"
        type="java.sql.Date"
        column="TXN_CUTOFF_DATE"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="latePaymentInterest"
        type="java.math.BigDecimal"
        column="LATE_PAYMENT_INTEREST"
        not-null="true"
        length="5"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="latePaymentAmount"
        type="java.math.BigDecimal"
        column="LATE_PAYMENT_AMOUNT"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="lastLatePaymentChargedDate"
        type="java.sql.Date"
        column="LAST_LATE_PAYMENT_CHARGED_DATE"
        length="7"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="earlyPaymentFlag"
        type="java.lang.String"
        column="EARLY_PAYMENT_FLAG"
        not-null="true"
        length="1"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="latePaymentFlag"
        type="java.lang.String"
        column="LATE_PAYMENT_FLAG"
        not-null="true"
        length="1"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="outstandingAmount"
        type="java.math.BigDecimal"
        column="OUTSTANDING_AMOUNT"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="totalFareAmount"
        type="java.math.BigDecimal"
        column="TOTAL_FARE_AMOUNT"
        not-null="true"
        length="12"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="totalNoOfTrip"
        type="int"
        column="TOTAL_NO_OF_TRIP"
        not-null="true"
        length="8"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="remarks"
        type="java.lang.String"
        column="REMARKS"
        length="500"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="billedFlag"
        type="java.lang.String"
        column="BILLED_FLAG"
        length="1"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="giroBankAcctNo"
        type="java.lang.String"
        column="GIRO_BANK_ACCT_NO"
        length="100"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="giroDay"
        type="java.lang.String"
        column="GIRO_DAY"
        length="4"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="updatedBy"
        type="java.lang.String"
        column="UPDATED_BY"
        length="80"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <property
        name="updatedDt"
        type="java.sql.Timestamp"
        column="UPDATED_DT"
        length="11"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>

    <property
        name="prepaidFlag"
        type="java.lang.String"
        column="PREPAID_FLAG"
        length="10"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
     <property
        name="currentTaxRate"
        type="java.math.BigDecimal"
        column="CURRENT_TAX_RATE"
        length="5"
    >
        <meta attribute="use-in-tostring">true</meta>
        <meta attribute="use-in-equals">true</meta>
    </property>
    <!-- Associations -->
  
    <!-- bi-directional many-to-one association to BmtbDraftInvFile -->
    <many-to-one
        name="bmtbDraftInvFile"
        class="com.cdgtaxi.ibs.common.model.BmtbDraftInvFile"
        not-null="true"
    >
        <meta attribute="use-in-equals">true</meta>
        <column name="FILE_NO" />
    </many-to-one>
    <!-- bi-directional many-to-one association to AmtbAccount -->
    <many-to-one
        name="amtbAccountByAccountNo"
        class="com.cdgtaxi.ibs.common.model.AmtbAccount"
        not-null="true"
    >
        <meta attribute="use-in-equals">true</meta>
        <column name="ACCOUNT_NO" />
    </many-to-one>
    <!-- bi-directional many-to-one association to AmtbAccount -->
    <many-to-one
        name="amtbAccountByDebtTo"
        class="com.cdgtaxi.ibs.common.model.AmtbAccount"
        not-null="true"
    >
        <meta attribute="use-in-equals">true</meta>
        <column name="DEBT_TO" />
    </many-to-one>
    <!-- bi-directional one-to-many association to BmtbDraftInvPaymentHeader -->
    <set
        name="bmtbDraftInvPaymentHeaders"
        lazy="true"
        inverse="true"
		cascade="all"
    >
        <key>
            <column name="INVOICE_HEADER_NO" />
        </key>
        <one-to-many 
            class="com.cdgtaxi.ibs.common.model.BmtbDraftInvPaymentHeader"
        />
    </set>
    <!-- bi-directional one-to-many association to BmtbDraftInvSummary -->
    <set
        name="bmtbDraftInvSummaries"
        lazy="true"
        inverse="true"
		cascade="all"
    >
        <key>
            <column name="INVOICE_HEADER_NO" />
        </key>
        <one-to-many 
            class="com.cdgtaxi.ibs.common.model.BmtbDraftInvSummary"
        />
    </set>
    <!-- bi-directional one-to-many association to BmtbDraftInvTxn -->
    <set
        name="bmtbDraftInvTxns"
        lazy="true"
        inverse="true"
		cascade="all"
    >
        <key>
            <column name="ISSUED_INVOICE_HEADER_NO" />
        </key>
        <one-to-many 
            class="com.cdgtaxi.ibs.common.model.BmtbDraftInvTxn"
        />
    </set>
    <!-- bi-directional many-to-one association to BmtbBillGenReq -->
    <many-to-one
        name="bmtbBillGenReq"
        class="com.cdgtaxi.ibs.common.model.BmtbBillGenReq"
        not-null="true"
    >
        <meta attribute="use-in-equals">true</meta>
        <column name="REQ_NO" />
    </many-to-one>

</class>

<sql-query name="deleteDraftInvFiles">
 <![CDATA[
	delete from bmtb_draft_inv_file
	where file_no in (
	  select
	    inv_file.file_no
	  from bmtb_draft_inv_file inv_file
	  left join bmtb_draft_inv_header inv_header on inv_header.file_no = inv_file.file_no
	  where inv_header.file_no is null
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvPaymentDetails">
 <![CDATA[
	delete from bmtb_draft_inv_payment_detail
	where INVOICE_PAYMENT_DETAIL_NO in (
	  select
	    INVOICE_PAYMENT_DETAIL_NO
	  from bmtb_draft_inv_payment_detail inv_pymt_detail
	  inner join BMTB_DRAFT_INV_PAYMENT_HEADER inv_pymt_header on inv_pymt_header.INVOICE_PAYMENT_NO = inv_pymt_detail.INVOICE_PAYMENT_NO
	  inner join bmtb_draft_inv_header bdih on bdih.INVOICE_HEADER_NO = inv_pymt_header.INVOICE_HEADER_NO
	  inner join amtb_account acct on acct.account_no = bdih.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvPaymentHeaders">
 <![CDATA[
	delete from BMTB_DRAFT_INV_PAYMENT_HEADER
	where INVOICE_PAYMENT_NO in (
	  select
	    INVOICE_PAYMENT_NO
	  from BMTB_DRAFT_INV_PAYMENT_HEADER inv_pymt_header
	  inner join bmtb_draft_inv_header bdih on bdih.INVOICE_HEADER_NO = inv_pymt_header.INVOICE_HEADER_NO
	  inner join amtb_account acct on acct.account_no = bdih.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvTxns">
 <![CDATA[
	delete from BMTB_DRAFT_INV_TXN
	where INVOICE_TXN_NO in (
	  select
	    INVOICE_TXN_NO
	  from BMTB_DRAFT_INV_TXN inv_txn
	  inner join BMTB_DRAFT_INV_DETAIL inv_detail on inv_txn.INVOICE_DETAIL_NO = inv_detail.INVOICE_DETAIL_NO
	  inner join BMTB_DRAFT_INV_SUMMARY inv_summary on inv_summary.INVOICE_SUMMARY_NO = inv_detail.INVOICE_SUMMARY_NO
	  inner join bmtb_draft_inv_header inv_header on inv_header.INVOICE_HEADER_NO = inv_summary.INVOICE_HEADER_NO
	  inner join amtb_account acct on acct.account_no = inv_header.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvDetails">
 <![CDATA[
	delete from BMTB_DRAFT_INV_DETAIL
	where INVOICE_DETAIL_NO in (
	  select
	    INVOICE_DETAIL_NO
	  from BMTB_DRAFT_INV_DETAIL inv_detail
	  inner join BMTB_DRAFT_INV_SUMMARY inv_summary on inv_summary.INVOICE_SUMMARY_NO = inv_detail.INVOICE_SUMMARY_NO
	  inner join bmtb_draft_inv_header inv_header on inv_header.INVOICE_HEADER_NO = inv_summary.INVOICE_HEADER_NO
	  inner join amtb_account acct on acct.account_no = inv_header.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvSummaries">
 <![CDATA[
	delete from BMTB_DRAFT_INV_SUMMARY
	where INVOICE_SUMMARY_NO in (
	  select
	    INVOICE_SUMMARY_NO
	  from BMTB_DRAFT_INV_SUMMARY inv_summary
	  inner join bmtb_draft_inv_header inv_header on inv_header.INVOICE_HEADER_NO = inv_summary.INVOICE_HEADER_NO
	  inner join amtb_account acct on acct.account_no = inv_header.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

<sql-query name="deleteDraftInvHeader">
 <![CDATA[
	delete from bmtb_draft_inv_header
	where INVOICE_HEADER_NO in (
	  select
	    INVOICE_HEADER_NO
	  from bmtb_draft_inv_header inv_header
	  inner join amtb_account acct on acct.account_no = inv_header.debt_to
	  left join amtb_account p_acct on p_acct.account_no = acct.parent_no
	  left join amtb_account gp_acct on gp_acct.account_no = p_acct.parent_no
	  where
	    acct.account_no = :accountNo
	    or
	    p_acct.account_no = :accountNo
	    or
	    gp_acct.account_no = :accountNo
	)
]]>
</sql-query>

</hibernate-mapping>
